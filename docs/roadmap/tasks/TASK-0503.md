# TASK-0503: Preflight Report Export

Status: done
Owner: OpenClaw
Links:
- PR: (tbd)

## Context

Release readiness signals now exist in-app (environment, artifact/signing, updater health), but teams still need a sharable report artifact for audits and handoff.

## Goals

- Export a preflight report that captures current release readiness snapshot
- Include environment, artifact, updater, and checklist status in one file
- Keep export flow lightweight and integrated in release checklist wizard

## Non-Goals

- Remote upload/report sync
- Historical report storage in app state
- Background scheduled export

## User Stories

- As a release engineer, I want to export the current preflight result, so I can share it in review/approval flows.
- As a release engineer, I want both human-readable and machine-readable output, so I can use the report in manual and automated processes.

## Requirements

### Functional

- R1: Add `export_preflight_report` backend command to write report file
- R2: Support `.md` (readable summary + raw JSON snapshot) and `.json` export
- R3: Add checklist UI export action with save dialog and status feedback
- R4: Report includes summary counters, gating result, checklist items, environment/artifact/updater snapshots

### Non-Functional

- N1: Reuse current runtime state (no new persistence)
- N2: Keep export behavior deterministic and side-effect minimal
- N3: Keep error messages actionable on serialization/write failures

## Technical Design

- New frontend module: `src/lib/preflight.ts`
  - Defines report payload contract
  - Wraps `export_preflight_report` command invocation
- Checklist integration: `src/components/release/ReleaseChecklistDialog.tsx`
  - Adds export button and busy state
  - Builds payload from existing in-memory data
- Backend command: `src-tauri/src/commands.rs`
  - Writes JSON report directly
  - Renders markdown report with summary/checklist/raw snapshot sections
- Command wiring: `src-tauri/src/lib.rs`

## Acceptance Criteria

- [x] AC1: User can export report from signed release checklist dialog
- [x] AC2: Markdown export includes summary, checklist, and raw snapshot
- [x] AC3: JSON export contains full preflight payload
- [x] AC4: Typecheck/tests/build pass

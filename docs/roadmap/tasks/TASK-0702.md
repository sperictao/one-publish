# TASK-0702: Prefix/Env Token Parsing Fidelity for Command Import

Status: done
Owner: OpenClaw
Links:
- PR: (tbd)

## Context

Current command import parser focuses on flag/value tokens. Prefix-based and env-prefixed patterns (`-Dkey=value`, `GOOS=linux`, `GOARCH=amd64`) are not fully preserved for provider mapping.

## Goals

- Improve parser fidelity for prefix/env tokens across providers
- Preserve map-like parameters for Java/Go command imports

## Non-Goals

- Full shell grammar parser
- Cross-command pipeline parsing

## Delivered

- Extended command parser to recognize schema-driven prefixed tokens before generic flag parsing
  - map-style prefixed token parsing for Java `-Dkey=value`
  - string-style prefixed token parsing for env-style assignments like `GOOS=linux` and `GOARCH=amd64`
- Added map-entry merge behavior for repeated map tokens to preserve multiple Java properties
- Added parser regression tests to lock behavior:
  - Java `-Dversion=...` / `-Dprofile=...` -> `properties` map
  - Go `GOOS/GOARCH` env tokens -> `target/arch`
  - dotnet/cargo flag parsing remains stable with schema-backed assertions

## Acceptance Criteria

- [x] AC1: Java `-Dkey=value` maps into properties map
- [x] AC2: Go `GOOS/GOARCH` env tokens map into target/arch
- [x] AC3: Existing import behavior for dotnet/cargo remains stable
